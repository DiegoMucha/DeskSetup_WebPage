<!DOCTYPE html>

<html lang = "en">
<head>
    <title>Carrito de Compras - DeskSetup Pro</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./css/styles-carrito-register.css">
    <link rel="stylesheet" href="css/style-footer.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>

<body>
    <!--Nav Bar-->
    <iframe src="navbar.html" width="100%" height="100%" style="border:none;" scrolling="no"></iframe>

    <!-- Contenido del Carrito -->
    <div class="container">
        <h1 class="text-center mt-5 mb-5">Carrito de compras</h1>

        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Producto</th>
                        <th>Precio</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody id="carrito-items">
                    <!-- Los items se cargarán dinámicamente -->
                </tbody>
            </table>
        </div>

        <div class="total text-end">
            <p>Total: $<span id="carrito-total">0</span></p>
            <button class="btn btn-primary continuar mb-5 mt-5" onclick="finalizarCompra()">Continuar compra</button>
        </div>
    </div>

    <!-- Footer -->
    <iframe src="footer.html" width="100%" height="130px" style="border:none;"></iframe>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Cargar productos del carrito
        function cargarCarrito() {
            const carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            const contenedor = document.getElementById('carrito-items');
            const totalElement = document.getElementById('carrito-total');
            let total = 0;

            contenedor.innerHTML = '';

            carrito.forEach((producto, index) => {
                total += parseFloat(producto.precio);
                contenedor.innerHTML += `
                    <tr>
                        <td>
                            <img src="${producto.imagen_url}" alt="${producto.nombre}" class="img-thumbnail" style="width: 100px">
                            ${producto.nombre}
                        </td>
                        <td>$${producto.precio}</td>
                        <td>
                            <button onclick="eliminarDelCarrito(${index})" class="btn btn-danger">
                                <i class="fas fa-trash"></i> Eliminar
                            </button>
                        </td>
                    </tr>
                `;
            });

            totalElement.textContent = total.toFixed(2);
        }

        // Eliminar producto del carrito
        function eliminarDelCarrito(index) {
            let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            carrito.splice(index, 1);
            localStorage.setItem('carrito', JSON.stringify(carrito));
            cargarCarrito();
        }

        // Finalizar compra
        function finalizarCompra() {
            alert('¡Gracias por tu compra!');
            localStorage.removeItem('carrito');
            cargarCarrito();
        }

        // Cargar carrito al iniciar la página
        document.addEventListener('DOMContentLoaded', cargarCarrito);
    </script>
</body>
</html>